# Домашнее задание к занятию "5.5. Оркестрация кластером Docker контейнеров на примере Docker Swarm"

 

 

## Задача 1

- В чём отличие режимов работы сервисов в Docker Swarm кластере: replication и global?

 

replication - Указывается количество реплик которое нужно запустить для сервиса, который будет обслуживать один и тот же контент.

 

global – Запускается одна задача на каждой ноде. Как правило это системы мониторинга или антивирусное обеспечение, которое необходимо на каждой ноде и работает на определенном порту.

 

- Какой алгоритм выбора лидера используется в Docker Swarm кластере?

 

Raft — алгоритм. Если обычный узел долго не получает сообщений от лидера, то он переходит в состояние кандидат и посылает другим узлам запрос на голосование. Другие узлы голосуют за того кандидата, от которого они получили первый запрос. Если кандидат получает сообщение от лидера, то он снимает свою кандидатуру и возвращается в обычное состояние. Если кандидат получает большинство голосов, то он становится лидером. Если же он не получил большинства (это случай, когда на кластере возникли сразу несколько кандидатов и голоса разделились), то кандидат ждёт случайное время и инициирует новую процедуру голосования.

Процедура голосования повторяется, пока не будет выбран лидер.

 

- Что такое Overlay Network? 

 

Сеть для взаимодействия сервисов расположенных в разных нодах.

 

## Задача 2

 

Создать ваш первый Docker Swarm кластер в Яндекс.Облаке

 

![Screen1](https://github.com/emilsuleymanov/devops-netology/blob/main/05-virt-05-docker-swarm/screen1.png)

![Screen2](https://github.com/emilsuleymanov/devops-netology/blob/main/05-virt-05-docker-swarm/screen2.png)

 

 

## Задача 3

Создать ваш первый, готовый к боевой эксплуатации кластер мониторинга, состоящий из стека микросервисов.

![Screen3](https://github.com/emilsuleymanov/devops-netology/blob/main/05-virt-05-docker-swarm/screen3.png)

![Screen4](https://github.com/emilsuleymanov/devops-netology/blob/main/05-virt-05-docker-swarm/screen4.png)

![Screen5](https://github.com/emilsuleymanov/devops-netology/blob/main/05-virt-05-docker-swarm/screen5.png)

 

Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:

 

## Задача 4

Выполнить на лидере Docker Swarm кластера команду (указанную ниже) и дать письменное описание её функционала, что она делает и зачем она нужна:

 

 

Спасибо за интересную ссылку - мало того, что познакомился с безопасным

механизмом работы докера с секретами (возможность передавать информацию о паролях, сертификатах, ключах и т.п. в сервисы, запущенные внутри

контейнеров докер) - без следов в history и т.п. "открытого"        использования в образах или репозиториях, так еще и узнал о том, что

внутри swarm взаимодействие происходит в зашифрованном виде, а также логи Raft шифруются тоже. По умолчанию происходит это прозрачным образом и автоматически - при подключении ноды в swarm и рестарте сервиса докер, но можно инициализировать swarm при запуске с параметром (или изменить параметр после начала работы по примеру команды из этогозадания) --autolock - в таком случае создается новый токен, которыйнеобходимо будет использовать для "распечатывания" swarm на нодах, после перезапуска на них сервиса докер. Если после перезапуска сервиса докер в таком swarm и не разблокировать токеном доступ для такого сервиса докер, то он не получит доступ к сервисам, запущенным в таком swarm, т.к. не сможет начать шифрованный обмен с другими менеджерами в swarm и не сможет расшифровать Raft log.

 

Данная команда включает функцию подтверждения изменения роя с помощью ключа шифрования.

 

 

![Screen6](https://github.com/emilsuleymanov/devops-netology/blob/main/05-virt-05-docker-swarm/screen6.png)
